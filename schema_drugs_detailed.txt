# MIMIC-IV 약물/투약 관련 상세 가이드

## 핵심 테이블 관계도
```
PRESCRIPTIONS (처방정보)
    ├── pharmacy_id → PHARMACY (약국 조제)
    ├── pharmacy_id → EMAR (전자투약기록)
    └── poe_id → POE (의사주문)

EMAR (전자투약기록)
    └── emar_id → EMAR_DETAIL (투약 상세)

POE (의사주문)
    └── poe_id → POE_DETAIL (주문 상세)
```

## 테이블별 상세 정보

### PRESCRIPTIONS (처방정보)
**테이블 개요**
환자에게 처방된 약물 정보가 저장된 핵심 테이블. 총 9,818개의 약물 항목과 3가지 약물 유형을 포함. 실제로 투약된 약물의 종류, 용량, 경로, 기간 등을 기록.

**테이블 연결 정보**
- 연결 테이블: patients, admissions, pharmacy, poe
- 연결 기준: subject_id, hadm_id, pharmacy_id, poe_id

**주요 식별자 컬럼**
- subject_id: 환자 고유 식별자 (patients 테이블과 조인)
- pharmacy_id: 약물 처방 단위 식별자 (각 처방 기록 구분)
- hadm_id: 입원 단위 식별자 (admissions 테이블과 연결)
- poe_id, poe_seq: 주문 Order 정보 연결용

**핵심 약물 정보 컬럼**
- drug_type: 약물 분류 (BASE, ADDITIVE, MAIN)
- drug: 약물 이름 (상품명 또는 일반명)
- starttime: 약물 처방 시작 시간 (실제 투약 시작 시점)
- stoptime: 약물 처방 종료 시간 (투약 종료 시점)
- route: 투약 경로 (PO(경구), IV(정맥주사), IM 등)
- dose_val_rx: 처방 용량 값
- dose_unit_rx: 처방 용량 단위 (mg, ml 등)
- doses_per_24_hrs: 1일 복용 횟수

**약물 분류 정보 (drug_type)**
- **BASE**: 기본 정맥 수액 (IV fluid base) - 주요 치료 목적의 핵심 약물로 항생제, 진통제, 혈압약의 주성분
- **ADDITIVE**: 첨가제 (Additive to base fluid) - 기본 약물 보조 또는 부작용 완화용으로 비타민, 전해질, 희석액, 안정제 등
- **MAIN**: 주요 투여 약물 (Primary medication) - 치료의 핵심이 되는 주성분으로 복합제에서 가장 중요한 활성 성분

**주요 처방 약물 (Top 10)**
1. **Sodium Chloride** (737,593회, 10.0%): 수액공급과 탈수 치료용 기본 수액
2. **Insulin** (631,411회, 8.6%): 당뇨병과 혈당조절용 내분비계 약물
3. **Potassium Chloride** (526,118회, 7.2%): 칼륨 보충과 부정맥 예방용 전해질
4. **Acetaminophen** (473,926회, 6.5%): 해열과 진통용 해열진통제
5. **Furosemide** (342,415회, 4.7%): 부종과 심부전 치료용 심혈관계 약물
6. **Heparin** (336,104회, 4.6%): 혈전 예방과 치료용 항응고제
7. **Docusate Sodium** (319,973회, 4.4%): 변비 예방용 위장관계 약물
8. **Magnesium Sulfate** (297,223회, 4.0%): 마그네슘 보충용 전해질
9. **HYDROmorphone** (294,572회, 4.0%): 중증 통증 관리용 마약성 진통제
10. **Bag** (265,786회, 3.6%): 수액 포장 및 운반용 용기

**약물 형태 (form_rx) 주요 항목**
- TAB/TABLET: 정제
- INJ: 주사제
- SOLN: 용액
- CAP: 캡슐형 제제
- SUSP: 현탁액
- SYRP: 시럽형 제제
- OINT: 연고
- PTCH: 피부 부착 패치
- INH: 흡입제
- SUPP: 좌약

**투약 경로 (route) 주요 항목**
- PO/ORAL: 구강 투여
- IV: 정맥주사
- IV DRIP: 정맥 점적 주입
- IM: 근육주사
- SC/SUBCUT: 피하주사
- INH/INHALATION: 흡입제
- NG: 비위관
- PR: 직장투여
- TD/TRANSDERMAL: 경피제
- TP: 국소도포

**활용 팁**
- drug와 route 조합으로 투약 방식 분석
- starttime과 stoptime으로 투약 기간 계산
- doses_per_24_hrs로 투약 빈도 분석
- drug_type으로 주요 약물과 보조 약물 구분

### PHARMACY (약국 조제)
**테이블 개요**
약국에서 처리된 조제 및 투약 공급 정보를 기록한 테이블. 전자의무기록 기반이 아닌, 약국 실제 조제 내용을 포함.

**테이블 연결 정보**
- 연결 테이블: patients, admissions, poe, prescriptions
- 연결 기준: subject_id, hadm_id, poe_id, pharmacy_id

**주요 컬럼 정보**
- pharmacy_id: 조제 이력 고유 식별자 (기본키)
- medication: 조제된 약물 이름 (예: "Acetaminophen 500 MG Tablet")
- starttime: 약물 조제 시작 시간 또는 계획된 시작 시간
- stoptime: 약물 조제 종료 또는 투약 종료 예정 시간
- route: 투여 경로 (IV, PO 등)
- frequency: 투약 빈도 (BID, TID, Q4H 등)
- proc_type: 조제 유형 (IV, PO, PRN 등)
- status: 조제 상태 (Verified, Discontinued 등)
- fill_quantity: 조제된 약의 총 수량

**투약 빈도 용어**
- BID: 하루 2회
- TID: 하루 3회
- QID: 하루 4회
- Q4H: 4시간마다
- Q6H: 6시간마다
- PRN: 필요시
- QHS: 잠자리에서
- AC: 식전
- PC: 식후

**활용 팁**
- prescriptions와 연결하여 처방-조제 비교 분석
- frequency로 투약 스케줄 분석
- status로 조제 완료/중단 여부 확인

### EMAR (전자투약기록)
**테이블 개요**
전자 투약 기록(Electronic Medication Administration Record)을 담은 테이블. 병상 간호사가 환자 및 약물의 바코드를 스캔함으로써 투약 사실을 자동으로 기록함.

**테이블 연결 정보**
- 연결 테이블: patients, admissions, pharmacy, prescriptions, poe, emar_detail
- 연결 기준: subject_id, hadm_id, pharmacy_id, poe_id, emar_id

**주요 컬럼 정보**
- emar_id: 전자 투약 기록 고유 ID
- charttime: 약물이 실제로 투약된 시각
- medication: 투약된 약물 이름
- event_txt: 투약 이벤트 설명
- scheduletime: 예정된 투약 시각
- storetime: 시스템에 투약이 기록된 시각

**event_txt 분류**
- **정상 수행(완료됨)**: Administered, Applied, Assessed, Confirmed, Flushed, Started, Stopped
- **정상 수행(다른 장소에서)**: "in Other Location"으로 시작하는 이벤트들
- **지연 수행**: "Delayed"로 시작하는 이벤트들
- **미시행/중단/예외 상황**: Not Given, Not Applied, Hold Dose, Partial Infusion

**활용 팁**
- charttime으로 실제 투약 시점 확인
- event_txt로 투약 성공/실패 여부 판단
- scheduletime과 charttime 비교로 투약 지연 분석

### EMAR_DETAIL (투약 상세)
**테이블 개요**
emar 테이블의 투약 기록에 대한 세부 정보를 보완하는 테이블. 각 약물 투여 건에 대해 실제 투약된 제제의 수량, 단위, 주입 속도, 투약 경로 등 상세 투약 행위를 기록함.

**테이블 연결 정보**
- 연결 테이블: emar, pharmacy
- 연결 기준: emar_id, pharmacy_id

**주요 컬럼 정보**
- dose_due: 예정된 용량
- dose_due_unit: 예정된 용량 단위
- dose_given: 실제 투약된 용량
- dose_given_unit: 실제 투약된 용량 단위
- route: 투약 경로
- site: 투약 부위 상세 위치
- barcode_type: 바코드 유형

**barcode_type 분류**
- **bc**: 경구약, 일반주사 등
- **if**: 수액, 영양제, 약물의 연속적 정맥 주입
- **iv**: 정맥 주사(IV), 보통은 일시적 정맥 주사
- **pmto**: 병원 외부에서 환자가 가지고 온 약을 병원에서 복용
- **ppn**: 말초 정맥을 통한 비경구 영양 공급
- **tpn**: 중심 정맥을 통한 완전 비경구 영양요법

**활용 팁**
- dose_due와 dose_given 비교로 투약 정확성 분석
- barcode_type으로 투약 방식 분류
- site로 투약 부위별 분석

### POE (의사주문)
**테이블 개요**
병원 내에서 의료진이 전자의무기록 시스템을 통해 처방/주문을 입력한 내역을 저장. 검사, 진단, 영상, 처방 등의 오더 기록 (실제 시행 여부가 아닌 '입력된 오더' 중심).

**테이블 연결 정보**
- 연결 테이블: patients, admissions, prescriptions, poe_detail
- 연결 기준: subject_id, hadm_id, poe_id

**주요 컬럼 정보**
- poe_id: 주문 그룹 식별자 (기본키)
- poe_seq: 동일 주문 그룹 내 순번
- ordertime: 주문이 입력된 시점
- order_type: 주문 분류 (medication, lab 등)
- concept_type: 주문 대상 유형

**활용 팁**
- ordertime으로 처방 시점 분석
- order_type으로 주문 종류별 분류
- poe_detail과 연결하여 상세 주문 내용 확인

### POE_DETAIL (주문 상세)
**테이블 개요**
poe 테이블의 상세 오더 항목을 저장하는 하위 테이블

**테이블 연결 정보**
- 연결 테이블: poe
- 연결 기준: poe_id, poe_seq

**주요 컬럼 정보**
- field_name: 주문의 속성명 (예: DRUG_NAME, FREQUENCY)
- field_value: 해당 속성의 값 (예: "Vancomycin", "BID")

**활용 팁**
- field_name과 field_value 조합으로 상세 주문 내용 분석
- 같은 poe_id 내 여러 field들로 완전한 처방 정보 구성